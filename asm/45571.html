<!DOCTYPE html>
<html>
<head>
<title>Technician Ted: Routine at B203</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />

</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html">Technician Ted</a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a href="45376.html">B140</a></span></td>
<td class="up">Up: <a href="../maps/all.html#45571">Map</a></td>
<td class="next"><span class="next-1">Next: <a href="45750.html">B2B6</a></span></td>
</tr>
</table>
<div class="description">B203: Print a set of task buttons</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="4">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="44663.html">AE77</a>.
</div>
</div>
<table class="input-1">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>
<tr>
<td class="register">A</td>
<td class="register-desc">Index of the button to draw</td>
</tr>
<tr>
<td class="register">HL</td>
<td class="register-desc">Pointer to button data</td>
</tr>
</table>
<table class="output-0">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>

</table>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="45571"></span>B203</td>
<td class="instruction">LD B,$02</td>
<td class="comment-11" rowspan="1">Two buttons to draw</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="45573"></span>B205</td>
<td class="instruction">PUSH BC</td>
<td class="comment-11" rowspan="1">Remember this</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45574"></span>B206</td>
<td class="instruction">SRL A</td>
<td class="comment-11" rowspan="1">Divide index by 2</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45576"></span>B208</td>
<td class="instruction">LD ($A433),A</td>
<td class="comment-11" rowspan="1">Store it</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45579"></span>B20B</td>
<td class="instruction">LD B,$00</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45581"></span>B20D</td>
<td class="instruction">RL B</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45583"></span>B20F</td>
<td class="instruction">LD C,(HL)</td>
<td class="comment-11" rowspan="1">Put next value in C</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45584"></span>B210</td>
<td class="instruction">INC HL</td>
<td class="comment-11" rowspan="1">Point to next entry in the room data</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45585"></span>B211</td>
<td class="instruction">LD ($A434),BC</td>
<td class="comment-11" rowspan="1">Store the character offset</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45589"></span>B215</td>
<td class="instruction">SLA B</td>
<td class="comment-11" rowspan="3">Convert to screen offset</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45591"></span>B217</td>
<td class="instruction">SLA B</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45593"></span>B219</td>
<td class="instruction">SLA B</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45595"></span>B21B</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-11" rowspan="1">Get character</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45596"></span>B21C</td>
<td class="instruction">LD ($A45F),A</td>
<td class="comment-11" rowspan="1">Store it</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45599"></span>B21F</td>
<td class="instruction">INC HL</td>
<td class="comment-11" rowspan="1">Point to next entry in the room data</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45600"></span>B220</td>
<td class="instruction">ADD A,A</td>
<td class="comment-11" rowspan="2">Shift characters to become an offset from the task button data</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45601"></span>B221</td>
<td class="instruction">ADD A,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45602"></span>B222</td>
<td class="instruction">PUSH HL</td>
<td class="comment-11" rowspan="1">Remember this</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45603"></span>B223</td>
<td class="instruction">LD HL,$9000</td>
<td class="comment-11" rowspan="1">Load base address of screen 2</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45606"></span>B226</td>
<td class="instruction">ADD HL,BC</td>
<td class="comment-11" rowspan="1">Add offset</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45607"></span>B227</td>
<td class="instruction">LD E,A</td>
<td class="comment-11" rowspan="1">Remember this</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45608"></span>B228</td>
<td class="instruction">LD D,$04</td>
<td class="comment-11" rowspan="1">Four characters</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="45610"></span>B22A</td>
<td class="instruction">LD A,E</td>
<td class="comment-11" rowspan="1">Get next character</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45611"></span>B22B</td>
<td class="instruction">LD BC,($A467)</td>
<td class="comment-11" rowspan="1">Get base address of task button UDGs</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45615"></span>B22F</td>
<td class="instruction">CALL <a href="46893.html#46896">$B730</a></td>
<td class="comment-11" rowspan="1">Print the character</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45618"></span>B232</td>
<td class="instruction">BIT 0,D</td>
<td class="comment-11" rowspan="1">Is this one of the rightmost characters?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45620"></span>B234</td>
<td class="instruction">JR Z,$B241</td>
<td class="comment-11" rowspan="1">Move forward of it isn't</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45622"></span>B236</td>
<td class="instruction">DEC L</td>
<td class="comment-11" rowspan="1">Move back one character</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45623"></span>B237</td>
<td class="instruction">LD A,L</td>
<td class="comment-11" rowspan="3">Move down a line</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45624"></span>B238</td>
<td class="instruction">ADD A,$1F</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45626"></span>B23A</td>
<td class="instruction">LD L,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45627"></span>B23B</td>
<td class="instruction">JR NC,$B241</td>
<td class="comment-11" rowspan="1">Move forward if we're still on the same third of a screen</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45629"></span>B23D</td>
<td class="instruction">LD A,H</td>
<td class="comment-11" rowspan="3">Move forward to the next third of a screen</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45630"></span>B23E</td>
<td class="instruction">XOR $08</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45632"></span>B240</td>
<td class="instruction">LD H,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="45633"></span>B241</td>
<td class="instruction">INC E</td>
<td class="comment-11" rowspan="1">Next character in store</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45634"></span>B242</td>
<td class="instruction">DEC D</td>
<td class="comment-11" rowspan="2">Repeat if there are more characters to print</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45635"></span>B243</td>
<td class="instruction">JR NZ,$B22A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45637"></span>B245</td>
<td class="instruction">POP HL</td>
<td class="comment-11" rowspan="2">Restore registers clobbered by the above routine</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45638"></span>B246</td>
<td class="instruction">POP BC</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45639"></span>B247</td>
<td class="instruction">DEC B</td>
<td class="comment-11" rowspan="1">Next button</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45640"></span>B248</td>
<td class="instruction">JR Z,$B25C</td>
<td class="comment-11" rowspan="1">Jump forward if both buttons are done</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45642"></span>B24A</td>
<td class="instruction">LD A,($A433)</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45645"></span>B24D</td>
<td class="instruction">LD ($A430),A</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45648"></span>B250</td>
<td class="instruction">LD DE,($A434)</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45652"></span>B254</td>
<td class="instruction">LD ($A431),DE</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45656"></span>B258</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-11" rowspan="1">Get next button data</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45657"></span>B259</td>
<td class="instruction">INC HL</td>
<td class="comment-11" rowspan="1">Point to next entry in the room data</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45658"></span>B25A</td>
<td class="instruction">JR $B205</td>
<td class="comment-11" rowspan="1">Do the next button</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<span id="45660"></span>
<div class="comments">
<div class="paragraph">
Draw the task button attributes
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="45660"></span>B25C</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-11" rowspan="1">Get the attribute</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45661"></span>B25D</td>
<td class="instruction">LD ($A436),A</td>
<td class="comment-11" rowspan="1">Store it</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45664"></span>B260</td>
<td class="instruction">INC HL</td>
<td class="comment-11" rowspan="1">Point to next entry in the room data</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45665"></span>B261</td>
<td class="instruction">PUSH HL</td>
<td class="comment-11" rowspan="1">Remember this</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45666"></span>B262</td>
<td class="instruction">LD DE,$A200</td>
<td class="comment-11" rowspan="1">Point DE to the base address of attributes 2</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45669"></span>B265</td>
<td class="instruction">LD BC,$001F</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45672"></span>B268</td>
<td class="instruction">LD A,($A457)</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45675"></span>B26B</td>
<td class="instruction">AND $80</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45677"></span>B26D</td>
<td class="instruction">LD HL,$A45B</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45680"></span>B270</td>
<td class="instruction">LD A,($A430)</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45683"></span>B273</td>
<td class="instruction">JR Z,$B28A</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45685"></span>B275</td>
<td class="instruction">BIT 3,(HL)</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45687"></span>B277</td>
<td class="instruction">JR Z,$B288</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45689"></span>B279</td>
<td class="instruction">LD A,($A422)</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45692"></span>B27C</td>
<td class="instruction">LD HL,$A43B</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45695"></span>B27F</td>
<td class="instruction">XOR (HL)</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45696"></span>B280</td>
<td class="instruction">LD A,($A430)</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45699"></span>B283</td>
<td class="instruction">JR NZ,$B28A</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45701"></span>B285</td>
<td class="instruction">SCF</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45702"></span>B286</td>
<td class="instruction">JR $B28A</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="45704"></span>B288</td>
<td class="instruction">OR $80</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="45706"></span>B28A</td>
<td class="instruction">PUSH AF</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45707"></span>B28B</td>
<td class="instruction">LD HL,($A431)</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45710"></span>B28E</td>
<td class="instruction">CALL <a href="45769.html">$B2C9</a></td>
<td class="comment-11" rowspan="1">Copy the attribute onto screen 2</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45713"></span>B291</td>
<td class="instruction">LD HL,($A434)</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45716"></span>B294</td>
<td class="instruction">POP AF</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45717"></span>B295</td>
<td class="instruction">LD A,($A433)</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45720"></span>B298</td>
<td class="instruction">RLA</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45721"></span>B299</td>
<td class="instruction">RRCA</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45722"></span>B29A</td>
<td class="instruction">CALL <a href="45769.html">$B2C9</a></td>
<td class="comment-11" rowspan="1">Copy the attribute onto screen 2</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45725"></span>B29D</td>
<td class="instruction">POP HL</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45726"></span>B29E</td>
<td class="instruction">LD A,($A45F)</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45729"></span>B2A1</td>
<td class="instruction">RLA</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45730"></span>B2A2</td>
<td class="instruction">JR C,$B2AC</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45732"></span>B2A4</td>
<td class="instruction">XOR A</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45733"></span>B2A5</td>
<td class="instruction">LD ($A45F),A</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45736"></span>B2A8</td>
<td class="instruction">LD ($A460),A</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45739"></span>B2AB</td>
<td class="instruction">RET</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="45740"></span>B2AC</td>
<td class="instruction">LD ($A45F),HL</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="45743"></span>B2AF</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45744"></span>B2B0</td>
<td class="instruction">INC HL</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45745"></span>B2B1</td>
<td class="instruction">INC HL</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45746"></span>B2B2</td>
<td class="instruction">RLA</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45747"></span>B2B3</td>
<td class="instruction">JR C,$B2AF</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="45749"></span>B2B5</td>
<td class="instruction">RET</td>
<td class="comment-11" rowspan="1"></td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a href="45376.html">B140</a></span></td>
<td class="up">Up: <a href="../maps/all.html#45571">Map</a></td>
<td class="next"><span class="next-1">Next: <a href="45750.html">B2B6</a></span></td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">Copyright Steve Marsden and David Cooke 1984. This dissassembly by Ritchie Swann 2018.</div>
<div class="created">Created using <a href="http://skoolkit.ca/">SkoolKit</a> 7.0.</div>
</footer>
</body>
</html>